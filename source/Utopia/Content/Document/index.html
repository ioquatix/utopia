<!DOCTYPE html>
<html>
	<head>
		
			<title>Utopia::Content::Document</title>
		
		<meta charset="UTF-8"/>
		<meta name="viewport" content="width=device-width, initial-scale=1"/>
		
		<link rel="icon" type="image/png" href="../../../../_static/icon.png"/>
		<link rel="stylesheet" href="../../../../_static/site.css" type="text/css" media="screen"/>
		
		<script src="../../../../_components/jquery/jquery.min.js"></script>
		<script src="../../../../_components/jquery-syntax/jquery.syntax.min.js"></script>
		
		<script src="../../../../_static/links.js"></script>
		
		<script type="text/javascript">
		//<![CDATA[
			jQuery(function($) {
				$.syntax();
			});
		//]]>
		</script>
	</head>

	<body>
		<header> › <a class="link" href="../../../../index.html">Project</a> › <a class="link" href="../../../index.html">Source</a></header>
		
		<main>
			
	<h1><code class="language-ruby">Utopia::Content::Document</code></h1>
	
	<p>A single request through content middleware. We use a struct to hide instance varibles since we instance_exec within this context.</p>
	
	
	<section>
	<h2>Definitions</h2>
	
	<section id="Utopia::Content::Document#controller"><h3><code class="language-ruby">def controller</code></h3><p>A helper method for accessing controller variables from view:</p>
<details>
						<summary><h4>Implementation</h4></summary>
						<pre><code class="language-ruby">def controller
	@controller ||= Utopia::Controller[request]
end</code></pre>
					</details></section><section id="Utopia::Content::Document#request"><h3><code class="language-ruby">attr :request</code></h3><p>The Rack::Request for this document.</p>
</section><section id="Utopia::Content::Document#attributes"><h3><code class="language-ruby">attr :attributes</code></h3><p>Per-document global attributes.</p>
</section><section id="Utopia::Content::Document#current"><h3><code class="language-ruby">attr :current</code></h3><p>The current state, represents a list from outer to inner most tag by traversing <a href="../State/index.html#Utopia%3A%3AContent%3A%3AState%23parent" title="State#parent"><code class="language-ruby">attr :parent</code></a>.
At any point in parsing markup, this is a list of the inner most tag,
then the next outer tag, etc.</p>
</section><section id="Utopia::Content::Document#first"><h3><code class="language-ruby">attr :first</code></h3><p>The first <a href="../State/index.html" title="State"><code class="language-ruby">class Utopia::Content::State</code></a> generated by rendering this document. It contains useful information
regarding the node and uri used to access the resource.</p>
</section><section id="Utopia::Content::Document#end_tags"><h3><code class="language-ruby">attr :end_tags</code></h3><p>End tags represents a list of execution order. This is the order that end tags
have appeared when evaluating nodes.</p>
</section><section id="Utopia::Content::Document#lookup_tag"><h3><code class="language-ruby">def lookup_tag(tag)</code></h3><p>Maps a tag to a node instance by asking the current node to lookup the tag name. This function is called for each tag and thus heavily affects performance.</p>
<details>
						<summary><h4>Implementation</h4></summary>
						<pre><code class="language-ruby">def lookup_tag(tag)
	# result = tag
	# 
	# # This loop works from inner to outer tags, and updates the tag we are currently searching for based on any overrides:
	# @begin_tags.reverse_each do |state|
	# 	result = state.lookup(result)
	# 	
	# 	return result if result.is_a?(Node)
	# end
	
	# This loop looks up a tag by asking the most embedded node to look it up based on tag name. This almost always only evaluates the top state:
	@end_tags.reverse_each do |state|
		return state.node.lookup_tag(tag) if state.node.respond_to?(:lookup_tag)
	end
	
	return nil
end</code></pre>
					</details></section><section id="Utopia::Content::Document#lookup_node"><h3><code class="language-ruby">def lookup_node(path)</code></h3><p>Lookup a node with the given path relative to the current node.</p>
<details>
						<summary><h4>Implementation</h4></summary>
						<pre><code class="language-ruby">def lookup_node(path)
	@end_tags.reverse_each do |state|
		return state.node.lookup_node(path) if state.node.respond_to?(:lookup_node)
	end
end</code></pre>
					</details></section><section id="Utopia::Content::Document#content"><h3><code class="language-ruby">def content</code></h3><p>The content of the node</p>
<details>
						<summary><h4>Implementation</h4></summary>
						<pre><code class="language-ruby">def content
	@end_tags.last.content
end</code></pre>
					</details></section>	</section>

				
			<footer>Documentation generated by <a href="https://github.com/socketry/utopia-project">Utopia::Project</a>.</footer>
		</main>
	</body>
</html>